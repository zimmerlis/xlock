# xlock
PowerShell Module for XLOCK Web App (xlock.app) - Update NFC Cards of Users in Locks

## About

The idea for this project arose from the need to manage all groups registered in a locking system (in our case, it was Glutz eAccess - Glutz eAccess) and all users with NFC cards with the same groups in the furniture locks of XLOCK (i.e., a second locking system - XLOCK). The goal of this PowerShell module is to automate programming in XLOCK. It can also be used to automatically load another CSV import file. Or, if a different locking system than Glutz is used, an export file from it can also be easily adapted.

## Installation

Git Clone to C:\Users\yourname\Documents\WindowsPowerShell\Modules (or in any ohter Power Shell Module folder of your choice).
Or download the content and place it in C:\Users\yourname\Documents\WindowsPowerShell\Modules\xlock.

## Quick Start

In the folder "how2use sample," there is an example of an export of all Glutz users, which is then used as an import file. Additionally, there is a userkeys.txt file that stores the Mifare tokens in various formats. This file is automatically generated and updated for new users and NFC cards. The xlockUpdate.ps1 file uses the PowerShell module xlock to update the users and groups.

Save these three files in a working directory where the project will run. On the first run, PowerShell should be executed with admin rights so that other PowerShell modules can be installed and loaded. Two folders, csv and log, will also be created to store the temporary export files and log files.

1. In the first run 
- the api key gets prompted and saved in Windows Credential Manager
- other PowerShell Module swill be installed and loaded
- all needed groups will be created in XLOCK

2. Then add manually the locks to the groups as needed.

3. On the next run, the cards of all users in the specified groups will be added to all locks within those groups accordingly.

If you want to disable or remove a lock from the system, remove it from the group and add it to the 000_DisabledLocks group. All users will then be removed. 
Alternatively, you can remove a lock from one group and add it to another. The users from the old group will be removed, and the users from the newly assigned group will be added on the next run.

## Limitation

Alle Locks must be only in one group.
